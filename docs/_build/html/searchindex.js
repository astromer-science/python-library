Search.setIndex({"docnames": ["ASTROMER", "ASTROMER.core", "index"], "filenames": ["ASTROMER.rst", "ASTROMER.core.rst", "index.rst"], "titles": ["ASTROMER", "Modules", "Welcome to ASTROMER documentation!"], "terms": {"The": [0, 1], "singl": 2, "band": 2, "encod": 2, "repres": 0, "main": 0, "class": [0, 1], "which": [0, 1], "load": 0, "fit": [0, 2], "train": [0, 1, 2], "weight": [0, 1, 2], "It": [0, 1], "took": 0, "everi": 0, "light": [0, 2], "curv": [0, 2], "mai": [0, 1], "vari": 0, "between": [0, 1], "differ": [0, 1], "star": 0, "thi": [0, 1, 2], "depend": [0, 1], "object": [0, 1], "survei": 0, "being": 0, "carri": 0, "out": 0, "x": [0, 1], "i": [0, 1, 2], "set": [0, 1], "observ": [0, 1], "celesti": 0, "over": 0, "time": [0, 1], "each": 0, "had": 0, "two": 0, "characterist": 0, "magnitud": [0, 1], "bright": 0, "modifi": 0, "julian": 0, "date": 0, "mjd": [0, 1], "when": [0, 1], "wa": [0, 2], "made": 0, "we": [0, 1], "propos": 0, "us": [0, 1, 2], "learn": [0, 2], "represent": [0, 2], "transform": [0, 2], "base": [0, 1, 2], "creat": [0, 1, 2], "embed": 0, "variabl": [0, 1], "dk": 0, "dimension": [0, 1], "space": 0, "make": 0, "easi": 0, "match": [0, 1], "other": [0, 1], "them": 0, "solv": 0, "downstream": 0, "task": 0, "classif": 0, "regress": 0, "sourc": [0, 1], "process": 0, "input": [0, 1], "gener": [0, 1, 2], "fix": 0, "size": [0, 1], "sinc": 0, "ha": [0, 1], "z": 0, "200x256": 0, "maximum": 0, "number": [0, 1], "remain": 0, "mask": 0, "so": 0, "same": 0, "length": [0, 1], "even": 0, "some": 0, "ar": [0, 1], "shorter": 0, "than": 0, "paramet": [0, 1], "num_lay": [0, 1], "integ": 0, "self": 0, "attent": 0, "block": 0, "layer": [0, 1], "d_model": [0, 1], "determin": 0, "": [0, 1], "intern": 0, "must": [0, 1], "divis": 0, "num_head": [0, 1], "head": 0, "an": 0, "dff": [0, 1], "neuron": 0, "fulli": 0, "connect": 0, "appli": [0, 1], "after": 0, "consist": 0, "linear": 0, "non": 0, "activ": 0, "function": 0, "float32": 0, "valu": [0, 1], "defin": 0, "minimum": 0, "wavelength": 0, "posit": 0, "see": 0, "equat": 0, "4": 0, "oliva": [0, 2], "donoso": [0, 2], "et": 0, "al": 0, "2022": 0, "rang": 0, "mechan": 0, "comput": 0, "dropout": [0, 1], "regular": 0, "output": 0, "prevent": 0, "overfit": 0, "randomli": 0, "drop": 0, "e": [0, 1], "zero": [0, 1], "fraction": [0, 1], "unit": [0, 1], "dure": 0, "maxlen": [0, 1], "limit": 0, "sequenc": [0, 1], "pass": [0, 1], "batch_siz": [0, 1], "sampl": [0, 1, 2], "forward": 0, "note": [0, 1], "epoch": [0, 1], "complet": 0, "all": 0, "batch": [0, 1], "were": 0, "default": [0, 1], "none": [0, 1], "dataset": [0, 1, 2], "oids_list": 0, "label": [0, 1], "1": [0, 1], "concaten": 0, "true": [0, 1], "method": [0, 1], "first": [0, 1], "check": [0, 1], "format": [0, 1], "contain": [0, 1], "Then": 0, "predefin": 0, "from": [0, 1, 2], "data": 0, "modul": 0, "In": 0, "part": 0, "more": 0, "200": [0, 1], "divid": [0, 1], "window": [0, 1], "through": 0, "obtain": 0, "can": [0, 1, 2], "list": [0, 1], "numpi": [0, 1], "arrai": [0, 1], "tensorflow": [0, 1], "id": [0, 1], "onli": [0, 1, 2], "provid": [0, 1], "allow": 0, "larger": 0, "option": [0, 1], "associ": 0, "within": [0, 1], "boolean": [0, 1], "indic": [0, 1], "whether": [0, 1], "vector": 0, "return": [0, 1], "train_batch": [0, 1], "valid_batch": [0, 1], "2": [0, 1], "patienc": [0, 1], "40": 0, "lr": [0, 1], "0": [0, 1], "001": [0, 1], "project_path": 0, "verbos": [0, 1], "given": [0, 1], "perform": [0, 2], "evalu": 0, "valid": [0, 1], "stop": 0, "improv": [0, 2], "specifi": 0, "alreadi": 0, "tf": [0, 1], "loop": 0, "where": [0, 1], "have": [0, 1], "been": 0, "A": [0, 1, 2], "float": [0, 1], "rate": 0, "path": [0, 1], "save": [0, 1], "log": 0, "progress": 0, "messag": 0, "print": 0, "abov": [0, 1], "50": 0, "sent": 0, "stdout": 0, "frequenc": 0, "increas": 0, "level": 0, "If": [0, 1, 2], "10": 0, "iter": [0, 1], "report": [0, 1], "from_pretrain": [0, 2], "name": [0, 1], "macho": [0, 1], "pre": [0, 2], "specif": [0, 1, 2], "astronom": 0, "user": 0, "easili": 0, "seri": [0, 1], "purpos": 0, "you": [0, 2], "local": 0, "download": 0, "upload": 0, "correspond": [0, 1], "should": [0, 1], "zip": 0, "file": 0, "http": 0, "github": 0, "com": 0, "scienc": 0, "load_weight": [0, 1, 2], "weights_fold": 0, "architectur": 0, "locat": 0, "directori": 0, "assum": 0, "checkpoint": 0, "folder": [0, 1], "holi": [], "download_weight": [0, 2], "url": 0, "target": [0, 1], "deliv": 0, "request": [0, 2], "avail": 0, "atla": 0, "ztfg": 0, "consid": 0, "code": [0, 1], "simpl": 0, "conveni": 0, "wai": 0, "extract": 0, "python": [0, 1], "instal": 0, "wheel": 0, "pip": 0, "import": 0, "initi": 0, "automat": [0, 1], "public": 0, "repositori": [0, 2], "instanc": [0, 1], "lenght": 0, "np": 0, "samples_collect": 0, "5200": 0, "3": 0, "5300": 0, "5": [0, 1], "5400": 0, "lx3": 0, "matric": 0, "std": 0, "To": 0, "attention_vector": 0, "easli": 0, "includ": [0, 1], "256": [0, 1], "128": 0, "1000": 0, "dimens": [0, 1], "formula": 0, "notic": [0, 1], "ignor": 0, "clean": 0, "mode": [0, 1], "train_data": 0, "validation_data": 0, "20": [0, 1], "1e": 0, "my_fold": 0, "earli": 0, "displai": 0, "inform": 0, "don": 0, "t": 0, "load_numpi": [0, 1], "pretraining_record": [0, 1], "both": 0, "For": 0, "larg": 0, "recommend": [0, 1], "record": [0, 1], "tutori": [0, 2], "execut": [0, 1], "pipelin": 0, "document": [], "your": 2, "scratch": 2, "share": 2, "submit": 2, "pull": 2, "core": 1, "get_astrom": 1, "10000": [0, 1], "use_leak": 1, "fals": [0, 1], "no_train": 1, "100": [0, 1], "predict": 1, "model": [1, 2], "conf": 1, "predic_proba": 1, "train_dataset": 1, "valid_dataset": 1, "exp_path": 1, "experi": 1, "test": 1, "finetun": [1, 2], "use_random": 1, "num_cl": 1, "train_step": 1, "opt": 1, "valid_step": 1, "return_pr": 1, "norm": 1, "multiheadattent": 1, "arg": 1, "kwarg": 1, "call": 1, "logic": 1, "live": 1, "state": 1, "except": 1, "its": 1, "invoc": 1, "wrap": 1, "creation": 1, "resourc": 1, "init_scop": 1, "nest": 1, "__init__": 1, "build": 1, "befor": 1, "tensor": 1, "dict": 1, "tupl": 1, "argument": 1, "subject": 1, "special": 1, "rule": 1, "explicitli": 1, "cannot": 1, "via": 1, "keyword": 1, "scalar": 1, "get": 1, "cast": 1, "kera": 1, "metadata": 1, "collect": 1, "built": 1, "input_shap": 1, "shape": 1, "info": 1, "input_spec": 1, "compat": 1, "against": 1, "mix": 1, "precis": 1, "behavior": 1, "handl": 1, "manual": 1, "savedmodel": 1, "integr": 1, "variou": 1, "ecosystem": 1, "packag": 1, "like": 1, "tfmot": 1, "tflite": 1, "j": 1, "etc": 1, "support": 1, "addit": 1, "although": 1, "reason": 1, "follow": [0, 1], "reserv": 1, "meant": 1, "infer": 1, "take": [0, 1], "previou": 1, "did": 1, "come": 1, "came": 1, "split_head": 1, "qkv": 1, "split": 1, "last": [0, 1], "depth": 1, "transpos": 1, "result": 1, "seq_len": 1, "scaled_dot_product_attent": 1, "q": 1, "k": 1, "v": 1, "calcul": 1, "lead": 1, "penultim": 1, "seq_len_k": 1, "seq_len_v": 1, "type": 1, "pad": [0, 1], "look": 1, "ahead": 1, "broadcast": 1, "queri": 1, "seq_len_q": 1, "kei": 1, "depth_v": 1, "attention_weight": 1, "adjust_fn": 1, "func": 1, "adjust_fn_clf": 1, "max_ob": [0, 1], "create_dataset": 1, "meta_df": 1, "raw_data": 1, "lc": 1, "n_job": 1, "subsets_frac": 1, "25": 1, "test_subset": 1, "max_lcs_per_record": 1, "create_gener": 1, "list_of_arrai": 1, "deseri": 1, "read": 1, "serial": 1, "convert": 1, "context": 1, "featur": 1, "write": 1, "binari": 1, "decod": 1, "divide_training_subset": 1, "frame": 1, "val": 1, "test_meta": 1, "subset": [0, 1], "datafram": 1, "astro": 1, "standard": 1, "dest": 1, "string": 1, "destin": 1, "x3": 1, "subfram": 1, "format_label": 1, "input_dict": 1, "get_exampl": 1, "lcid": 1, "lightcurv": [0, 1], "exampl": 1, "int": 1, "error": 1, "get_window": 1, "pivot": 1, "shuffl": [0, 1], "msk_frac": [0, 1], "rnd_frac": [0, 1], "same_frac": [0, 1], "repeat": [0, 1], "mask_sampl": 1, "y": 1, "msk_prob": 1, "rnd_prob": 1, "same_prob": 1, "pretrain": [1, 2], "n_class": 1, "loader": 1, "bert": 1, "strategi": 1, "no_shuffl": 1, "bool": 1, "do": 1, "max": 1, "per": 1, "replac": 1, "random": [0, 1], "withg": 1, "preprocess": [1, 2], "process_lc3": 1, "lc_index": 1, "numpy_lc": 1, "writer": 1, "sample_lc": 1, "write_record": 1, "uniqu": 1, "encoderlay": 1, "point_wise_feed_forward_network": 1, "custom_bc": 1, "y_true": 1, "y_pred": 1, "sample_weight": 1, "custom_rms": 1, "create_look_ahead_mask": 1, "get_mask": 1, "frac": 1, "15": 1, "add": 1, "percentag": 1, "distribut": 1, "get_padding_mask": 1, "step": 1, "reshape_mask": 1, "reshap": 1, "set_random": 1, "serie_1": 1, "mask_1": 1, "serie_2": 1, "current": 1, "place": 1, "element": 1, "custom_acc": 1, "reglay": 1, "saucelay": 1, "subclass": 1, "implement": 1, "overrid": 1, "thei": 1, "need": 1, "instanti": 1, "invok": 1, "typic": 1, "discret": 1, "tensorshap": 1, "expect": 1, "one": 1, "init": 1, "plot_cm": 1, "cm": 1, "ax": 1, "titl": 1, "fontsiz": 1, "cbar": 1, "yticklabel": 1, "class_nam": 1, "confus": 1, "matrix": 1, "get_angl": 1, "get_angles_origin": 1, "positional_encod": 1, "customschedul": 1, "warmup_step": 1, "4000": 1, "learningrateschedul": 1, "draw_graph": 1, "logdir": 1, "decor": 1, "store": 1, "fn": 1, "graph": 1, "save_scalar": 1, "get_folder_nam": 1, "prefix": 1, "chang": [0, 1], "get_metr": 1, "path_log": 1, "metric_nam": 1, "epoch_loss": 1, "my_summary_iter": 1, "axi": 1, "return_mean": 1, "subtract": 1, "mean": 1, "dim": 1, "turn": 1, "origin": 1, "scale": 1, "million": 2, "novel": 2, "deep": 2, "version": 2, "work": 2, "project": 2, "publish": 2, "c": 2, "becker": 2, "p": 2, "protopapa": 2, "g": [0, 2], "cabrera": 2, "vive": 2, "m": 2, "vishnu": 2, "h": 2, "vardhan": 2, "2023": 2, "670": 2, "a54": 2, "feb": 2, "23": [], "rebuilt": 2, "weekli": 2, "singlebandencod": [0, 2], "util": 2, "quick": 2, "start": 2, "fine": 2, "tune": 2, "classifi": [], "loss": [], "metric": [], "plot": [], "schedul": [], "tboard": [], "contribut": [], "text": [], "py": [], "texto": [], "attribut": [], "attr": [], "attret": [], "get_conf": 1, "get_fc_attent": 1, "num_class": 1, "weigth": 1, "fc": 1, "att": 1, "get_lstm_attent": 1, "lstm": 1, "get_lstm_no_attent": 1, "test_batch": 1, "predict_from_path": 1, "24": 2, "make_pretrain": [0, 2], "numpy_arg": 0, "agregar": [], "expl\u00edcitament": [], "si": [], "listado": [], "receiv": [], "extens": [], "inst": [], "our": 0, "rearrang": 0, "instead": 0, "how": 0, "big": 0, "720": 0, "7": 0, "case": 0, "point": 0, "order": 0, "unmask": 0, "feed": 0, "either": 0, "bumpi": 0, "At": 0, "end": 0, "explain": 0, "section": 0}, "objects": {"ASTROMER.core": [[1, 0, 0, "-", "astromer"], [1, 0, 0, "-", "attention"], [1, 0, 0, "-", "classifier"], [1, 0, 0, "-", "data"], [1, 0, 0, "-", "encoder"], [1, 0, 0, "-", "losses"], [1, 0, 0, "-", "masking"], [1, 0, 0, "-", "metrics"], [1, 0, 0, "-", "output"], [1, 0, 0, "-", "plots"], [1, 0, 0, "-", "positional"], [1, 0, 0, "-", "scheduler"], [1, 0, 0, "-", "tboard"], [1, 0, 0, "-", "utils"]], "ASTROMER.core.astromer": [[1, 1, 1, "", "get_ASTROMER"], [1, 1, 1, "", "predict"], [1, 1, 1, "", "train"], [1, 1, 1, "", "train_step"], [1, 1, 1, "", "valid_step"]], "ASTROMER.core.attention": [[1, 2, 1, "", "MultiHeadAttention"], [1, 1, 1, "", "scaled_dot_product_attention"]], "ASTROMER.core.attention.MultiHeadAttention": [[1, 3, 1, "", "call"], [1, 3, 1, "", "split_heads"]], "ASTROMER.core.classifier": [[1, 1, 1, "", "get_conf"], [1, 1, 1, "", "get_fc_attention"], [1, 1, 1, "", "get_lstm_attention"], [1, 1, 1, "", "get_lstm_no_attention"], [1, 1, 1, "", "load_weights"], [1, 1, 1, "", "predict"], [1, 1, 1, "", "predict_from_path"], [1, 1, 1, "", "train"], [1, 1, 1, "", "train_step"], [1, 1, 1, "", "valid_step"]], "ASTROMER.core.data": [[1, 1, 1, "", "adjust_fn"], [1, 1, 1, "", "adjust_fn_clf"], [1, 1, 1, "", "create_dataset"], [1, 1, 1, "", "create_generator"], [1, 1, 1, "", "deserialize"], [1, 1, 1, "", "divide_training_subset"], [1, 1, 1, "", "format_label"], [1, 1, 1, "", "get_example"], [1, 1, 1, "", "get_window"], [1, 1, 1, "", "get_windows"], [1, 1, 1, "", "load_numpy"], [1, 1, 1, "", "mask_sample"], [1, 1, 1, "", "pretraining_records"], [1, 1, 1, "", "process_lc3"], [1, 1, 1, "", "sample_lc"], [1, 1, 1, "", "write_records"]], "ASTROMER.core.encoder": [[1, 2, 1, "", "Encoder"], [1, 2, 1, "", "EncoderLayer"], [1, 1, 1, "", "point_wise_feed_forward_network"]], "ASTROMER.core.encoder.Encoder": [[1, 3, 1, "", "call"]], "ASTROMER.core.encoder.EncoderLayer": [[1, 3, 1, "", "call"]], "ASTROMER.core.losses": [[1, 1, 1, "", "custom_bce"], [1, 1, 1, "", "custom_rmse"]], "ASTROMER.core.masking": [[1, 1, 1, "", "create_look_ahead_mask"], [1, 1, 1, "", "get_masked"], [1, 1, 1, "", "get_padding_mask"], [1, 1, 1, "", "reshape_mask"], [1, 1, 1, "", "set_random"]], "ASTROMER.core.metrics": [[1, 1, 1, "", "custom_acc"]], "ASTROMER.core.output": [[1, 2, 1, "", "RegLayer"], [1, 2, 1, "", "SauceLayer"]], "ASTROMER.core.output.RegLayer": [[1, 3, 1, "", "call"]], "ASTROMER.core.output.SauceLayer": [[1, 3, 1, "", "build"], [1, 3, 1, "", "call"], [1, 3, 1, "", "init"]], "ASTROMER.core.plots": [[1, 1, 1, "", "plot_cm"]], "ASTROMER.core.positional": [[1, 1, 1, "", "get_angles"], [1, 1, 1, "", "get_angles_original"], [1, 1, 1, "", "positional_encoding"]], "ASTROMER.core.scheduler": [[1, 2, 1, "", "CustomSchedule"]], "ASTROMER.core.tboard": [[1, 1, 1, "", "draw_graph"], [1, 1, 1, "", "save_scalar"]], "ASTROMER.core.utils": [[1, 1, 1, "", "get_folder_name"], [1, 1, 1, "", "get_metrics"], [1, 1, 1, "", "my_summary_iterator"], [1, 1, 1, "", "standardize"]], "ASTROMER": [[0, 0, 0, "-", "models"], [0, 0, 0, "-", "preprocessing"], [0, 0, 0, "-", "utils"]], "ASTROMER.models": [[0, 2, 1, "", "SingleBandEncoder"]], "ASTROMER.models.SingleBandEncoder": [[0, 3, 1, "", "encode"], [0, 3, 1, "", "fit"], [0, 3, 1, "", "from_pretraining"], [0, 3, 1, "", "load_weights"]], "ASTROMER.preprocessing": [[0, 1, 1, "", "make_pretraining"]], "ASTROMER.utils": [[0, 1, 1, "", "download_weights"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "titleterms": {"astrom": [0, 1, 2], "model": 0, "singlebandencod": [], "preprocess": 0, "util": [0, 1], "quick": 0, "start": 0, "fine": 0, "tune": 0, "go": [], "deep": [], "our": [], "resourc": 2, "contribut": 2, "modul": 1, "attent": 1, "classifi": 1, "data": 1, "encod": [0, 1], "loss": 1, "mask": 1, "metric": 1, "output": 1, "plot": 1, "posit": 1, "schedul": 1, "tboard": 1, "welcom": 2, "document": 2, "librari": 2, "singl": 0, "band": 0, "text": [], "texto": []}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"Modules": [[1, "modules"]], "astromer": [[1, "module-ASTROMER.core.astromer"]], "attention": [[1, "module-ASTROMER.core.attention"]], "classifier": [[1, "module-ASTROMER.core.classifier"]], "data": [[1, "module-ASTROMER.core.data"]], "encoder": [[1, "module-ASTROMER.core.encoder"]], "losses": [[1, "module-ASTROMER.core.losses"]], "masking": [[1, "module-ASTROMER.core.masking"]], "metrics": [[1, "module-ASTROMER.core.metrics"]], "output": [[1, "module-ASTROMER.core.output"]], "plots": [[1, "module-ASTROMER.core.plots"]], "positional": [[1, "module-ASTROMER.core.positional"]], "scheduler": [[1, "module-ASTROMER.core.scheduler"]], "tboard": [[1, "module-ASTROMER.core.tboard"]], "utils": [[1, "module-ASTROMER.core.utils"]], "Welcome to ASTROMER documentation!": [[2, "welcome-to-astromer-documentation"]], "LIBRARY DOCUMENTATION": [[2, null]], "Resources": [[2, "resources"]], "Contributing to ASTROMER": [[2, "contributing-to-astromer"]], "ASTROMER": [[0, "astromer"]], "Models": [[0, "models"]], "Single-Band Encoder": [[0, "single-band-encoder"]], "Preprocessing": [[0, "preprocessing"]], "Utils": [[0, "module-ASTROMER.utils"]], "Quick-start": [[0, "quick-start"]], "Fine Tune": [[0, "fine-tune"]]}, "indexentries": {"astromer.models": [[0, "module-ASTROMER.models"]], "astromer.preprocessing": [[0, "module-ASTROMER.preprocessing"]], "astromer.utils": [[0, "module-ASTROMER.utils"]], "singlebandencoder (class in astromer.models)": [[0, "ASTROMER.models.SingleBandEncoder"]], "download_weights() (in module astromer.utils)": [[0, "ASTROMER.utils.download_weights"]], "encode() (astromer.models.singlebandencoder method)": [[0, "ASTROMER.models.SingleBandEncoder.encode"]], "fit() (astromer.models.singlebandencoder method)": [[0, "ASTROMER.models.SingleBandEncoder.fit"]], "from_pretraining() (astromer.models.singlebandencoder method)": [[0, "ASTROMER.models.SingleBandEncoder.from_pretraining"]], "load_weights() (astromer.models.singlebandencoder method)": [[0, "ASTROMER.models.SingleBandEncoder.load_weights"]], "make_pretraining() (in module astromer.preprocessing)": [[0, "ASTROMER.preprocessing.make_pretraining"]], "module": [[0, "module-ASTROMER.models"], [0, "module-ASTROMER.preprocessing"], [0, "module-ASTROMER.utils"]]}})